CREATE TABLE users(
       username VARCHAR(50) NOT NULL PRIMARY KEY,
       password VARCHAR(100) NOT NULL,
       enabled BOOLEAN DEFAULT TRUE
)

CREATE TABLE authorities(
       username VARCHAR(50) NOT NULL,
       authority VARCHAR(50) NOT NULL,
       PRIMARY KEY(username, authority),
       FOREIGN KEY(username) REFERENCES users(username) ON DELETE CASCADE
)

CREATE TABLE domain(
       id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
       name VARCHAR(50) NOT NULL UNIQUE,
       description VARCHAR(255) DEFAULT '',
       active BOOLEAN DEFAULT TRUE,
       backup BOOLEAN DEFAULT FALSE,
       created TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
       modified TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE mailbox(
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	domain_id BIGINT NOT NULL,
	email VARCHAR(100) NOT NULL,
	password VARCHAR(256) NOT NULL,
	active BOOLEAN DEFAULT TRUE,
	created TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
	modified TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
	CONSTRAINT unique_email UNIQUE (email),
	FOREIGN KEY (domain_id) REFERENCES domain(id) ON DELETE CASCADE
);

CREATE TABLE alias(
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	domain_id BIGINT NOT NULL,
	destination VARCHAR(100) NOT NULL,
	redirect VARCHAR(100) NOT NULL,
	active BOOLEAN DEFAULT TRUE,
	created TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
	modified TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
	FOREIGN KEY (domain_id) REFERENCES domain(id) ON DELETE CASCADE
);
